<!DOCTYPE html>
<html lang="hi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SelectBook ‚Äì Login</title>
  <style>
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: #f4f6fb;
      color: #222;
    }
    .navbar {
      background: #0d47a1;
      color: #fff;
      padding: 10px 16px;
      font-weight: bold;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .navbar-title {
      font-size: 18px;
    }
    .navbar-links a {
      color: #fff;
      text-decoration: none;
      margin-left: 12px;
      font-size: 14px;
    }
    .auth-wrapper {
      max-width: 400px;
      margin: 40px auto;
      background: #fff;
      border-radius: 10px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
      padding: 20px 18px 24px;
    }
    .auth-title {
      font-size: 20px;
      font-weight: 600;
      margin-bottom: 4px;
      text-align: center;
    }
    .auth-sub {
      font-size: 13px;
      color: #555;
      text-align: center;
      margin-bottom: 16px;
    }
    label {
      display: block;
      font-size: 13px;
      margin-bottom: 4px;
      margin-top: 10px;
    }
    input {
      width: 100%;
      padding: 8px 10px;
      border: 1px solid #d0d5e2;
      border-radius: 6px;
      font-size: 14px;
    }
    .btn-row {
      display: flex;
      gap: 10px;
      margin-top: 16px;
    }
    button {
      flex: 1;
      padding: 9px 10px;
      border-radius: 6px;
      border: none;
      font-size: 14px;
      cursor: pointer;
    }
    #signupBtn {
      background: #e3f2fd;
      color: #0d47a1;
      border: 1px solid #90caf9;
    }
    #loginBtn {
      background: #0d47a1;
      color: #fff;
    }
    #logoutBtn {
      background: #ff7043;
      color: #fff;
      width: 100%;
      margin-top: 10px;
    }
    .status {
      margin-top: 12px;
      font-size: 13px;
      min-height: 18px;
    }
    .status.error { color: #d32f2f; }
    .status.ok { color: #2e7d32; }
    .user-box {
      margin-top: 14px;
      padding: 10px;
      background: #e8f5e9;
      border-radius: 6px;
      font-size: 13px;
    }
    .hidden { display: none; }
  </style>
</head>
<body>

  <!-- Simple Navbar -->
  <div class="navbar">
    <div class="navbar-title">SelectBook</div>
    <div class="navbar-links">
      <a href="index.html">Home</a>
      <a href="login.html">Login</a>
    </div>
  </div>

  <!-- Auth Card -->
  <div class="auth-wrapper">
    <div class="auth-title">Student Login / Signup</div>
    <div class="auth-sub">Email ‡§î‡§∞ Password ‡§∏‡•á Account ‡§¨‡§®‡§æ‡§è‡§Ç ‡§Ø‡§æ Login ‡§ï‡§∞‡•á‡§Ç‡•§</div>

    <label for="email">Email</label>
    <input type="email" id="email" placeholder="example@mail.com" />

    <label for="password">Password (‡§ï‡§Æ ‡§∏‡•á ‡§ï‡§Æ 6 ‡§Ö‡§ï‡•ç‡§∑‡§∞)</label>
    <input type="password" id="password" placeholder="******" />

    <div class="btn-row">
      <button id="signupBtn">New User / Signup</button>
      <button id="loginBtn">Login</button>
    </div>

    <div id="status" class="status"></div>

    <div id="userBox" class="user-box hidden">
      <div><b>Login ‡§π‡•Å‡§Ü:</b> <span id="userEmail"></span></div>
      <button id="logoutBtn">Logout</button>
    </div>
  </div>

  <!-- Firebase Auth Script -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-app.js";
    import {
      getAuth,
      createUserWithEmailAndPassword,
      signInWithEmailAndPassword,
      signOut,
      onAuthStateChanged
    } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-auth.js";

    // üëâ ‡§Ø‡§π‡§æ‡§Å ‡§Ö‡§™‡§®‡§æ firebaseConfig ‡§°‡§æ‡§≤‡•ã (‡§ú‡•ã ‡§§‡•Å‡§Æ‡§®‡•á test-engine.html ‡§Æ‡•á‡§Ç ‡§°‡§æ‡§≤‡§æ ‡§•‡§æ)
    const firebaseConfig = {
      apiKey: "AIzaSyBVNl7TyK2QKo-jrwnodZQ6RN8Ib4zqT6M",
      authDomain: "selectbook-test.firebaseapp.com",
      projectId: "selectbook-test",
      storageBucket: "selectbook-test.appspot.com",
      messagingSenderId: "325583536202",
      appId: "1:325583536202:web:25f3d7594ceca79cc726b3"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    window.auth = auth; // future use

    const emailInput   = document.getElementById("email");
    const passInput    = document.getElementById("password");
    const signupBtn    = document.getElementById("signupBtn");
    const loginBtn     = document.getElementById("loginBtn");
    const logoutBtn    = document.getElementById("logoutBtn");
    const statusBox    = document.getElementById("status");
    const userBox      = document.getElementById("userBox");
    const userEmailDom = document.getElementById("userEmail");

    function setStatus(msg, type = "") {
      statusBox.textContent = msg;
      statusBox.className = "status " + (type === "error" ? "error" : type === "ok" ? "ok" : "");
    }

    signupBtn.addEventListener("click", async () => {
      const email = emailInput.value.trim();
      const pass  = passInput.value.trim();

      if (!email || !pass) {
        setStatus("Email ‡§î‡§∞ Password ‡§¶‡•ã‡§®‡•ã‡§Ç ‡§≠‡§∞‡•á‡§Ç‡•§", "error");
        return;
      }
      if (pass.length < 6) {
        setStatus("Password ‡§ï‡§Æ ‡§∏‡•á ‡§ï‡§Æ 6 ‡§Ö‡§ï‡•ç‡§∑‡§∞ ‡§ï‡§æ ‡§π‡•ã‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è‡•§", "error");
        return;
      }

      try {
        await createUserWithEmailAndPassword(auth, email, pass);
        setStatus("Signup ‡§∏‡§´‡§≤ ‚úÖ ‡§Ü‡§™ ‡§≤‡•â‡§ó‡§ø‡§® ‡§π‡•ã ‡§ó‡§è ‡§π‡•à‡§Ç‡•§", "ok");
        // Optional: login ‡§ï‡•á ‡§¨‡§æ‡§¶ ‡§π‡•ã‡§Æ ‡§™‡•á‡§ú ‡§™‡§∞ ‡§≠‡•á‡§ú‡§®‡§æ ‡§π‡•ã ‡§§‡•ã ‡§Ö‡§ó‡§≤‡•Ä ‡§≤‡§æ‡§á‡§® uncomment ‡§ï‡§∞‡•ã:
        // window.location.href = "index.html";
      } catch (err) {
        setStatus("Signup error: " + err.message, "error");
      }
    });

    loginBtn.addEventListener("click", async () => {
      const email = emailInput.value.trim();
      const pass  = passInput.value.trim();

      if (!email || !pass) {
        setStatus("Email ‡§î‡§∞ Password ‡§¶‡•ã‡§®‡•ã‡§Ç ‡§≠‡§∞‡•á‡§Ç‡•§", "error");
        return;
      }

      try {
        await signInWithEmailAndPassword(auth, email, pass);
        setStatus("Login ‡§∏‡§´‡§≤ ‚úÖ", "ok");
// 1 ‡§∏‡•á‡§ï‡§Ç‡§° ‡§ï‡•á ‡§¨‡§æ‡§¶ ‡§π‡•ã‡§Æ ‡§™‡•á‡§ú (Test Series ‡§µ‡§æ‡§≤‡§æ) ‡§™‡§∞ ‡§≤‡•á ‡§ú‡§æ‡§ì
setTimeout(() => {
  window.location.href = "index.html#tests";
}, 1000);
        // Optional redirect:
        // window.location.href = "index.html";
      } catch (err) {
        setStatus("Login error: " + err.message, "error");
      }
    });

    logoutBtn.addEventListener("click", async () => {
      try {
        await signOut(auth);
        setStatus("Logout ‡§π‡•ã ‡§ó‡§Ø‡§æ‡•§", "ok");
      } catch (err) {
        setStatus("Logout error: " + err.message, "error");
      }
    });

    // User state change ‚Äì UI update
    onAuthStateChanged(auth, (user) => {
      if (user) {
        userBox.classList.remove("hidden");
        userEmailDom.textContent = user.email;
      } else {
        userBox.classList.add("hidden");
        userEmailDom.textContent = "";
      }
    });
  </script>
</body>
</html>